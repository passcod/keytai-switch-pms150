// initialisation
set COMP+ to internal voltage reference
set PA3 to PWM, minimum duty cycle / off

// set data lines to idle mode
label LOOP
set PA0 to interrupt mode
set PA5 to RST

sleep until interrupt

// data upload/download routine //
when interrupt fires:

set PA0 as I/O
set PA5 as I/O

PA0 will be a clock input, PA5 the data line
one bit per clock high

// read peripherals
set PA7 as COMP-
read COMP into RAM as coord_x
set PA6 as COMP-
read COMP into RAM as coord_y
set PA4 as COMP-
read COMP

decode this value into two variables in RAM:
(btn1, btn2)
(0, 0) from 0 to 1/3
(1, 0) from 1/3 to 1/2
(0, 1) from 1/2 to 2/3
(1, 1) from 2/3 to 1

// output portion
pull PA5 for 4 clock beats to indicate start of message
PA5 << write value of coord_x as 4 bits
PA5 << write value of coord_y as 4 bits
PA5 << write value of btn1 as 1 bit
PA5 << write value of btn2 as 1 bit

// input portion
listen for PA5 being pulled for 4 beats
PA5 >> read 8 bit value into RAM as led
set PWM to value of led variable

goto LOOP
